# Bulk-RNAseq analysis - From Raw reads to Count matrix

RNA sequencing (RNA-Seq) is a powerful and widely used technique for studying the transcriptome, the complete set of RNA transcripts produced by the genome under specific conditions or in a specific cell type. 

Unlike traditional microarrays, RNA-Seq provides a high-resolution, quantitative, and unbiased view of gene expression, enabling researchers to identify differentially expressed genes, discover novel transcripts, detect alternative splicing events, and quantify gene expression across the entire genome.

The RNA-Seq data analysis process can be broadly divided into two main stages: 

* The transformation of raw sequencing reads into a count matrix, and the 
* Downstream statistical and functional interpretation of gene expression data.

Altogether, the RNA-Seq analysis workflow is a multi-step process that transforms raw sequencing data into biologically meaningful insights, enabling researchers to understand gene regulation, identify biomarkers, and study disease mechanisms at the transcriptomic level.

# A. The transformation of raw sequencing reads into a count matrix:

1. It begins with quality control of raw sequencing reads in FASTQ format. 

2. Tools like FastQC are commonly used to evaluate sequencing quality, identify adapter contamination, and detect technical biases. If necessary, low-quality reads and adapter sequences are trimmed using programs such as Trimmomatic.

3. The cleaned reads are then aligned to a reference genome or transcriptome using aligners like HISAT2.

4. Following alignment, gene- or transcript-level quantification is performed with tools like featureCounts, resulting in a count matrix that represents the number of reads mapped to each gene across all samples.


# Setting Up

# PART A: Creating conda Environment and Installation of tools

Before beginning RNA-seq data analysis, it's essential to establish a reproducible and isolated environment. This ensures that all dependencies are correctly installed and consistent across runs. The following steps set up a conda environment tailored for both preprocessing and downstream differential expression analysis.

# Install tools for RNA-Seq Analysis

"conda install -y -c bioconda fastqc multiqc trimmomatic hisat2 samtools subread"

This command installs the core command-line tools necessary for RNA-seq data processing:

§ FastQC: Quality control tool for raw sequencing reads.
§ Trimmomatic: Adapter and quality trimming tool for FASTQ files.
§ HISAT2: Fast and sensitive alignment tool for mapping reads to a reference genome.
§ SAMtools: Suite of tools for manipulating alignments in the SAM/BAM format.
§ Subread: Provides the featureCounts tool used for gene-level quantification.

# PART B: Create Directories

To maintain a clean and organized workspace throughout the RNA-seq analysis, it's best practice to create a structured directory layout. This ensures that files generated at different stages of the pipeline are stored in dedicated folders, making the workflow easier to manage and debug.

Command 

These commands create subdirectories within your project folder (BulkTranscriptomics) for different stages of the analysis:

• FASTQ: Raw sequencing data (downloaded FASTQ files).
• FASTQC_Results: Output from FastQC quality control checks.
• TRIMMED: Adapter- and quality-trimmed FASTQ files.
• ALIGN: Intermediate alignment files
• BAM: Final sorted BAM files after alignment.
• REFERENCE: Reference genome files and annotation files
• COUNTS: Read count files generated by featureCounts.

# PART C: Download Datasets (from GEO):

To begin RNA-seq analysis using GEO datasets, raw sequencing data must first be downloaded from the NCBI Sequence Read Archive (SRA). This step uses the SRA Toolkit, specifically fasterq-dump, which is optimized for high-speed FASTQ file retrieval.

# Install sra-tools

Installs the SRA Toolkit, a command-line suite for downloading and processing data from NCBI's SRA.

"conda install -c bioconda sra-tools=3.0.7" (provided version number)

# Downloading SRA Datasets with fasterq-dump

fasterq-dump is a faster alternative to fastq-dump, designed to efficiently retrieve FASTQ files.

To retrieve a list of accession numbers (of raw data) from NCBI's SRA Run Selector, go to https://www.ncbi.nlm.nih.gov/Traces/study/ and enter your SRA Study Accession Number
(e.g., PRJNAxxxxxx or SRPxxxxxx) into the search bar. 

Once the associated sequencing runs are displayed, select the specific samples you are interested in by checking the corresponding boxes. After making your selection, click on the "Accession List" button located at the top-right side of the table. This will download a plain-text file containing the selected SRA Run Accessions (e.g., SRR numbers)

If You Have a Few SRR IDs:

"fasterq-dump SRR11262284 SRR11262285 SRR11262286 SRR11262292 SRR11262293 SRR11262294 --threads 10 --progress --split-files"

§ --threads: Number of threads for faster processing.
§ --progress: Shows live progress.
§ --split-files: Splits paired-end reads into _1.fastq and _2.fastq.

# Using GNU parallel (faster downloads):

"parallel -j 2 'fasterq-dump {} --threads 4 --split-files --progress -O $FASTQ' ::: SRR11262284 SRR11262285 SRR11262286 SRR11262292 SRR11262293 SRR11262294"

§ GNU parallel executes multiple downloads concurrently for improved speed.
§ -j 2: Runs 2 downloads in parallel.
§ Ensures efficient use of CPU and bandwidth.

# Other Options:

Option A: If you have many SRR IDs (All in one line):

"for srr in $(cat srr_list.txt); do fasterq-dump "$srr" --threads 6 --progress --split-files -O raw_fastq/; done"

Option B: If there are many files – one SRR ID in one line:

"while read srr; do fasterq-dump "$srr" --threads 6 --progress --split-files -O raw_fastq/; done < srr_list.txt" 

§ These loops automate downloading when SRR IDs are saved in a file (srr_list.txt). Output directory is specified using -O.

# PART D: Downloading Reference Genome and Gene Annotation Files:

To perform read alignment and gene-level quantification, you'll need a reference genome file and its corresponding gene annotation file (GTF). These files should match the version used in downstream tools to ensure accurate mapping and counting.

# Reference Genome (FASTA)

The grch38_genome.tar.gz file is a pre-built HISAT2 reference genome index for the human GRCh38 assembly, used for aligning RNA-Seq reads in transcriptomics analysis. It contains
.ht2 index files required by HISAT2 for fast and accurate alignment. 

It can be downloaded from: https://daehwankimlab.github.io/hisat2/download/#h-sapiens

"wget -P $REFERENCE https://genome-idx.s3.amazonaws.com/hisat/grch38_genome.tar.gz"

The grch38_genome.tar.gz file contains eight HISAT2 index files. These .ht2 files are binary index files generated from the GRCh38 reference genome and are required by HISAT2 to
perform sequence alignment. They represent different parts of the indexed genome, split for efficient loading and access during alignment.

# About the Dataset:

This repository provides a complete, step-by-step hands-on/workshop for performing RNA-seq data analysis using publicly available datasets from the Gene Expression Omnibus (GEO). The dataset used in this project, GSE106305, contains

The aim of this tutorial is to demonstrate how to process, analyze, and interpret RNA-seq data in a reproducible manner, covering the entire workflow from raw FASTQ files to the identification of differentially expressed genes and downstream biological insights.

The dataset for this study includes two groups: 

SRR

# B.Downstream statistical and functional interpretation of gene expression data:

1. The downstream analysis of this count data to derive meaningful biological insights. 

2. Differential gene expression (DGE) analysis is typically performed using statistical frameworks such as DESeq2 to identify genes that show significant changes in expression between conditions or experimental groups. 

3. The results are often visualized using principal component analysis (PCA), heatmaps, and volcano plots to explore sample relationships and highlight key regulatory genes. 

4. To interpret the biological relevance of differentially expressed genes, functional enrichment analysis is carried out using gene ontology (GO) and pathway analysis tools such as clusterProfiler or GSEA. 

5. This integrative workflow allows researchers to move from raw sequencing data to a deeper understanding of cellular states, molecular functions, and regulatory mechanisms underlying the biological system under study.

# Differential expression analysis using DeSeq2 in R:

DESeq2 uses a statistical model based on the negative binomial distribution to identify genes that show significant differences in expression between experimental conditions
(for example, Control vs. Disease).

In this workshop, we'll perform Differential Expression Analysis (DEA) using the DESeq2 package in R. The goal is to identify genes that are significantly upregulated or downregulated between the two conditions (Normaxia vs Hypoxia) in 2 different celllines (LNCaP vs PC3) using RNA-Seq count data generated from preprocessing the sequence reads from GSE106305.

All analyses in this step have been conducted in RStudio. Make sure you have both R and RStudio installed. You can download and install them by following the instructions available here: https://posit.co/download/rstudio-desktop/

# Step 1: Install Required Packages in R

Before any analysis, install all the necessary packages that will be used throughout the workflow. R’s Bioconductor repository hosts specialized bioinformatics tools. DESeq2 and other packages are maintained there to ensure reproducibility and compatibility.


